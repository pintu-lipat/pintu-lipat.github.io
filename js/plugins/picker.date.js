!function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(g,h){var i=this,j=g.$node[0],k=j.value,l=g.$node.data("value"),v=l||k,w=l?h.formatSubmit:h.format,x=function(){return j.currentStyle?"rtl"==j.currentStyle.direction:"rtl"==getComputedStyle(g.$root[0]).direction};i.settings=h,i.$node=g.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(h.disable||[]).slice(0),i.item.enable=-function(m){return m[0]===!0?m.shift():-1}(i.item.disable),i.set("min",h.min).set("max",h.max).set("now"),v?i.set("select",v,{format:w,defaultValue:!0}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return x()?-1:1},37:function(){return x()?1:-1},go:function(m){var n=i.item.highlight,o=new Date(n.year,n.month,n.date+m);i.set("highlight",o,{interval:m}),this.render()}},g.on("render",function(){g.$root.find("."+h.klass.selectMonth).on("change",function(){var m=this.value;m&&(g.set("highlight",[g.get("view").year,m,g.get("highlight").date]),g.$root.find("."+h.klass.selectMonth).trigger("focus"))}),g.$root.find("."+h.klass.selectYear).on("change",function(){var m=this.value;m&&(g.set("highlight",[m,g.get("view").month,g.get("highlight").date]),g.$root.find("."+h.klass.selectYear).trigger("focus"))})},1).on("open",function(){var m="";i.disabled(i.get("now"))&&(m=":not(."+h.klass.buttonToday+")"),g.$root.find("button"+m+", select").attr("disabled",!1)},1).on("close",function(){g.$root.find("button, select").attr("disabled",!0)},1)}var d=7,e=6,f=a._;c.prototype.set=function(g,h,i){var j=this,k=j.item;return null===h?("clear"==g&&(g="select"),k[g]=h,j):(k["enable"==g?"disable":"flip"==g?"enable":g]=j.queue[g].split(" ").map(function(l){return h=j[l](g,h,i)}).pop(),"select"==g?j.set("highlight",k.select,i):"highlight"==g?j.set("view",k.highlight,i):g.match(/^(flip|min|max|disable|enable)$/)&&(k.select&&j.disabled(k.select)&&j.set("select",k.select,i),k.highlight&&j.disabled(k.highlight)&&j.set("highlight",k.highlight,i)),j)},c.prototype.get=function(g){return this.item[g]},c.prototype.create=function(g,h,i){var j,k=this;return h=void 0===h?g:h,h==-(1/0)||h==1/0?j=h:b.isPlainObject(h)&&f.isInteger(h.pick)?h=h.obj:b.isArray(h)?(h=new Date(h[0],h[1],h[2]),h=f.isDate(h)?h:k.create().obj):h=f.isInteger(h)||f.isDate(h)?k.normalize(new Date(h),i):k.now(g,h,i),{year:j||h.getFullYear(),month:j||h.getMonth(),date:j||h.getDate(),day:j||h.getDay(),obj:j||h,pick:j||h.getTime()}},c.prototype.createRange=function(g,h){var i=this,j=function(k){return k===!0||b.isArray(k)||f.isDate(k)?i.create(k):k};return f.isInteger(g)||(g=j(g)),f.isInteger(h)||(h=j(h)),f.isInteger(g)&&b.isPlainObject(h)?g=[h.year,h.month,h.date+g]:f.isInteger(h)&&b.isPlainObject(g)&&(h=[g.year,g.month,g.date+h]),{from:j(g),to:j(h)}},c.prototype.withinRange=function(g,h){return g=this.createRange(g.from,g.to),h.pick>=g.from.pick&&h.pick<=g.to.pick},c.prototype.overlapRanges=function(g,h){var i=this;return g=i.createRange(g.from,g.to),h=i.createRange(h.from,h.to),i.withinRange(g,h.from)||i.withinRange(g,h.to)||i.withinRange(h,g.from)||i.withinRange(h,g.to)},c.prototype.now=function(g,h,i){return h=new Date,i&&i.rel&&h.setDate(h.getDate()+i.rel),this.normalize(h,i)},c.prototype.navigate=function(g,h,i){var j,k,l,v,w=b.isArray(h),x=b.isPlainObject(h),y=this.item.view;if(w||x){for(x?(k=h.year,l=h.month,v=h.date):(k=+h[0],l=+h[1],v=+h[2]),i&&i.nav&&y&&y.month!==l&&(k=y.year,l=y.month),j=new Date(k,l+(i&&i.nav?i.nav:0),1),k=j.getFullYear(),l=j.getMonth();new Date(k,l,v).getMonth()!==l;){v-=1}h=[k,l,v]}return h},c.prototype.normalize=function(g){return g.setHours(0,0,0,0),g},c.prototype.measure=function(g,h){var i=this;return h?"string"==typeof h?h=i.parse(g,h):f.isInteger(h)&&(h=i.now(g,h,{rel:h})):h="min"==g?-(1/0):1/0,h},c.prototype.viewset=function(g,h){return this.create([h.year,h.month,1])},c.prototype.validate=function(h,j,k){var l,m,n,o,p=this,C=j,D=k&&k.interval?k.interval:1,E=-1===p.item.enable,F=p.item.min,g=p.item.max,i=E&&p.item.disable.filter(function(q){if(b.isArray(q)){var r=p.create(q).pick;r<j.pick?l=!0:r>j.pick&&(m=!0)}return f.isInteger(q)}).length;if((!k||!k.nav&&!k.defaultValue)&&(!E&&p.disabled(j)||E&&p.disabled(j)&&(i||l||m)||!E&&(j.pick<=F.pick||j.pick>=g.pick))){for(E&&!i&&(!m&&D>0||!l&&0>D)&&(D*=-1);p.disabled(j)&&(Math.abs(D)>1&&(j.month<C.month||j.month>C.month)&&(j=C,D=D>0?1:-1),j.pick<=F.pick?(n=!0,D=1,j=p.create([F.year,F.month,F.date+(j.pick===F.pick?0:-1)])):j.pick>=g.pick&&(o=!0,D=-1,j=p.create([g.year,g.month,g.date+(j.pick===g.pick?0:1)])),!n||!o);){j=p.create([j.year,j.month,j.date+D])}}return j},c.prototype.disabled=function(g){var h=this,i=h.item.disable.filter(function(j){return f.isInteger(j)?g.day===(h.settings.firstDay?j:j-1)%7:b.isArray(j)||f.isDate(j)?g.pick===h.create(j).pick:b.isPlainObject(j)?h.withinRange(j,g):void 0});return i=i.length&&!i.filter(function(j){return b.isArray(j)&&"inverted"==j[3]||b.isPlainObject(j)&&j.inverted}).length,-1===h.item.enable?!i:i||g.pick<h.item.min.pick||g.pick>h.item.max.pick},c.prototype.parse=function(g,h,i){var j=this,k={};return h&&"string"==typeof h?(i&&i.format||(i=i||{},i.format=j.settings.format),j.formats.toArray(i.format).map(function(l){var m=j.formats[l],n=m?f.trigger(m,j,[h,k]):l.replace(/^!/,"").length;m&&(k[l]=h.substr(0,n)),h=h.substr(n)}),[k.yyyy||k.yy,+(k.mm||k.m)-1,k.dd||k.d]):h},c.prototype.formats=function(){function g(i,j,k){var l=i.match(/[^\x00-\x7F]+|\w+/)[0];return k.mm||k.m||(k.m=j.indexOf(l)+1),l.length}function h(i){return i.match(/\w+/)[0].length}return{d:function(i,j){return i?f.digits(i):j.date},dd:function(i,j){return i?2:f.lead(j.date)},ddd:function(i,j){return i?h(i):this.settings.weekdaysShort[j.day]},dddd:function(i,j){return i?h(i):this.settings.weekdaysFull[j.day]},m:function(i,j){return i?f.digits(i):j.month+1},mm:function(i,j){return i?2:f.lead(j.month+1)},mmm:function(i,j){var k=this.settings.monthsShort;return i?g(i,k,j):k[j.month]},mmmm:function(i,j){var k=this.settings.monthsFull;return i?g(i,k,j):k[j.month]},yy:function(i,j){return i?2:(""+j.year).slice(2)},yyyy:function(i,j){return i?4:j.year},toArray:function(i){return i.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(i,j){var k=this;return k.formats.toArray(i).map(function(l){return f.trigger(k.formats[l],k,[0,j])||l.replace(/^!/,"")}).join("")}}}(),c.prototype.isDateExact=function(g,h){var i=this;return f.isInteger(g)&&f.isInteger(h)||"boolean"==typeof g&&"boolean"==typeof h?g===h:(f.isDate(g)||b.isArray(g))&&(f.isDate(h)||b.isArray(h))?i.create(g).pick===i.create(h).pick:b.isPlainObject(g)&&b.isPlainObject(h)?i.isDateExact(g.from,h.from)&&i.isDateExact(g.to,h.to):!1},c.prototype.isDateOverlap=function(g,h){var i=this,j=i.settings.firstDay?1:0;return f.isInteger(g)&&(f.isDate(h)||b.isArray(h))?(g=g%7+j,g===i.create(h).day+1):f.isInteger(h)&&(f.isDate(g)||b.isArray(g))?(h=h%7+j,h===i.create(g).day+1):b.isPlainObject(g)&&b.isPlainObject(h)?i.overlapRanges(g,h):!1},c.prototype.flipEnable=function(g){var h=this.item;h.enable=g||(-1==h.enable?1:-1)},c.prototype.deactivate=function(g,h){var i=this,j=i.item.disable.slice(0);return"flip"==h?i.flipEnable():h===!1?(i.flipEnable(1),j=[]):h===!0?(i.flipEnable(-1),j=[]):h.map(function(k){for(var l,m=0;m<j.length;m+=1){if(i.isDateExact(k,j[m])){l=!0;break}}l||(f.isInteger(k)||f.isDate(k)||b.isArray(k)||b.isPlainObject(k)&&k.from&&k.to)&&j.push(k)}),j},c.prototype.activate=function(g,h){var i=this,j=i.item.disable,k=j.length;return"flip"==h?i.flipEnable():h===!0?(i.flipEnable(1),j=[]):h===!1?(i.flipEnable(-1),j=[]):h.map(function(l){var m,n,o,s;for(o=0;k>o;o+=1){if(n=j[o],i.isDateExact(n,l)){m=j[o]=null,s=!0;break}if(i.isDateOverlap(n,l)){b.isPlainObject(l)?(l.inverted=!0,m=l):b.isArray(l)?(m=l,m[3]||m.push("inverted")):f.isDate(l)&&(m=[l.getFullYear(),l.getMonth(),l.getDate(),"inverted"]);break}}if(m){for(o=0;k>o;o+=1){if(i.isDateExact(j[o],l)){j[o]=null;break}}}if(s){for(o=0;k>o;o+=1){if(i.isDateOverlap(j[o],l)){j[o]=null;break}}}m&&j.push(m)}),j.filter(function(l){return null!=l})},c.prototype.nodes=function(j){var l=this,m=l.settings,n=l.item,o=n.now,p=n.select,q=n.highlight,r=n.view,E=n.disable,F=n.min,G=n.max,g=function(s,t){return m.firstDay&&(s.push(s.shift()),t.push(t.shift())),f.node("thead",f.node("tr",f.group({min:0,max:d-1,i:1,node:"th",item:function(u){return[s[u],m.klass.weekdays,'scope=col title="'+t[u]+'"']}})))}((m.showWeekdaysFull?m.weekdaysFull:m.weekdaysShort).slice(0),m.weekdaysFull.slice(0)),h=function(s){return f.node("div"," ",m.klass["nav"+(s?"Next":"Prev")]+(s&&r.year>=G.year&&r.month>=G.month||!s&&r.year<=F.year&&r.month<=F.month?" "+m.klass.navDisabled:""),"data-nav="+(s||-1)+" "+f.ariaAttr({role:"button",controls:l.$node[0].id+"_table"})+' title="'+(s?m.labelMonthNext:m.labelMonthPrev)+'"')},i=function(){var s=m.showMonthsShort?m.monthsShort:m.monthsFull;return m.selectMonths?f.node("select",f.group({min:0,max:11,i:1,node:"option",item:function(t){return[s[t],0,"value="+t+(r.month==t?" selected":"")+(r.year==F.year&&t<F.month||r.year==G.year&&t>G.month?" disabled":"")]}}),m.klass.selectMonth,(j?"":"disabled")+" "+f.ariaAttr({controls:l.$node[0].id+"_table"})+' title="'+m.labelMonthSelect+'"'):f.node("div",s[r.month],m.klass.month)},k=function(){var s=r.year,t=m.selectYears===!0?5:~~(m.selectYears/2);if(t){var u=F.year,v=G.year,w=s-t,x=s+t;if(u>w&&(x+=u-w,w=u),x>v){var y=w-u,z=x-v;w-=y>z?z:y,x=v}return f.node("select",f.group({min:w,max:x,i:1,node:"option",item:function(A){return[A,0,"value="+A+(s==A?" selected":"")]}}),m.klass.selectYear,(j?"":"disabled")+" "+f.ariaAttr({controls:l.$node[0].id+"_table"})+' title="'+m.labelYearSelect+'"')}return f.node("div",s,m.klass.year)};return f.node("div",(m.selectYears?k()+i():i()+k())+h()+h(1),m.klass.header)+f.node("table",g+f.node("tbody",f.group({min:0,max:e-1,i:1,node:"tr",item:function(s){var t=m.firstDay&&0===l.create([r.year,r.month,1]).day?-7:0;return[f.group({min:d*s-r.day+t+1,max:function(){return this.min+d-1},i:1,node:"td",item:function(u){u=l.create([r.year,r.month,u+(m.firstDay?1:0)]);var v=p&&p.pick==u.pick,w=q&&q.pick==u.pick,x=E&&l.disabled(u)||u.pick<F.pick||u.pick>G.pick,y=f.trigger(l.formats.toString,l,[m.format,u]);return[f.node("div",u.date,function(z){return z.push(r.month==u.month?m.klass.infocus:m.klass.outfocus),o.pick==u.pick&&z.push(m.klass.now),v&&z.push(m.klass.selected),w&&z.push(m.klass.highlighted),x&&z.push(m.klass.disabled),z.join(" ")}([m.klass.day]),"data-pick="+u.pick+" "+f.ariaAttr({role:"gridcell",label:y,selected:v&&l.$node.val()===y?!0:null,activedescendant:w?!0:null,disabled:x?!0:null})),"",f.ariaAttr({role:"presentation"})]}})]}})),m.klass.table,'id="'+l.$node[0].id+'_table" '+f.ariaAttr({role:"grid",controls:l.$node[0].id,readonly:!0}))+f.node("div",f.node("button",m.today,m.klass.buttonToday,"type=button data-pick="+o.pick+(j&&!l.disabled(o)?"":" disabled")+" "+f.ariaAttr({controls:l.$node[0].id}))+f.node("button",m.clear,m.klass.buttonClear,"type=button data-clear=1"+(j?"":" disabled")+" "+f.ariaAttr({controls:l.$node[0].id}))+f.node("button",m.close,m.klass.buttonClose,"type=button data-close=true "+(j?"":" disabled")+" "+f.ariaAttr({controls:l.$node[0].id})),m.klass.footer)},c.defaults=function(g){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:g+"table",header:g+"header",navPrev:g+"nav--prev",navNext:g+"nav--next",navDisabled:g+"nav--disabled",month:g+"month",year:g+"year",selectMonth:g+"select--month",selectYear:g+"select--year",weekdays:g+"weekday",day:g+"day",disabled:g+"day--disabled",selected:g+"day--selected",highlighted:g+"day--highlighted",now:g+"day--today",infocus:g+"day--infocus",outfocus:g+"day--outfocus",footer:g+"footer",buttonClear:g+"button--clear",buttonToday:g+"button--today",buttonClose:g+"button--close"}}}(a.klasses().picker+"__"),a.extend("pickadate",c)});